<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
    <title>M02 UF2</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css"
          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <!-- Bootstrap Core JavaScript -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
            integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js"
            integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js"
            integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
            crossorigin="anonymous"></script>

    <style>
            code {
              font-family: Consolas,"courier new";
              color: crimson;
              background-color: #f1f1f1;
              padding: 2px;
              font-size: 105%;
            }
            pre {
                display: block;
                padding: 9.5px;
                margin: 0 0 10px;
                font-size: 13px;
                line-height: 1.42857143;
                word-break: break-all;
                word-wrap: break-word;
                color: #333;
                background-color: #f5f5f5;
                border: 1px solid #ccc;
                border-radius: 4px;
            }

    </style>
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-light bg-light">
    <a class="navbar-brand" href="../index.html">M02 BASES DE DADES</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
            aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
            <li class="nav-item">
                <a class="nav-link" href="UFs/UF1.html">UF1</a>
            </li>
            <li class="nav-item active">
                <a class="nav-link" href="UFs/UF2.html">UF2</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="UFs/UF3.html">UF3</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="UFs/UF4.html">UF3</a>
            </li>
        </ul>
    </div>
</nav>
<div class="card" style="margin-left:20%;margin-right:20%">
    <br/>
    <br/>
    <br/>
    <h3 class="card-header text-center font-weight-bold text-uppercase py-4">M02 BASES DE DADES</h3>
    <div class="card-body">

        <!-- HERE COMES THE CODE -->


        <h1 id="-span-style-color-009688-m02-uf2-span-"><span style="color:#009688">M02 UF2</span></h1>
        <h2 id="-span-style-color-4dd0e1-lenguaje-sql-span-"><span style="color:#4dd0e1">LENGUAJE SQL</span></h2>
        <p>Las sentencias de bases de datos se pueden agrupar en:</p>
        <ul>
            <li><p><span style="color:#009688">DDL</span> (<span style="color:#4dd0e1">Data Definition Language</span>): Definición de la estructura de almacenamiento de datos. Create, drop, alter…</p>
            </li>
            <li><p><span style="color:#009688">DML</span> (<span style="color:#4dd0e1">Data Manipulation Language</span>): Consulta y modificación de datos. Select, Insert, update, delete…</p>
            </li>
            <li><p><span style="color:#009688">DCL</span> (<span style="color:#4dd0e1">Data Control Language</span>): administra el acceso a los datos. Grant, revoke…</p>
            </li>
        </ul>
        <br/>
        <br/>
        <h3 id="ordenes-span-style-color-009688-ddl-span-sobre-base-de-datos">Ordenes <span style="color:#009688">DDL</span> sobre base de datos</h3>
        <p>Para crear una base de datos se realiza con la orden <code>CREATE DATABASE</code> aunque <code>CREATE SCHEMA</code> es sinónima, es decir que hará lo mismo</p>
        <pre class="prettyprint lang-sql"><code><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">DATABASE</span> NOMBRE_SCHEMA
</code></pre><p>Con la orden <code>DROP [DATABASE | SCHEMA]</code> borramos una base de datos</p>
        <pre class="prettyprint lang-sql"><code><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">DATABASE</span> NOMBRE_SCHEMA
</code></pre>
        <br/>
        <br/>
        <h3 id="sintaxis-de-span-style-color-009688-create-table-span-crear-tabla-">Sintaxis de <span style="color:#009688">CREATE TABLE</span> (crear tabla)</h3>
        <pre class="prettyprint lang-sql"><code>CREATE <span class="hljs-keyword">TABLE</span> nombre_tabla <span class="hljs-comment">(</span>
    nombre_columna tipocolumna [restricciones_columna],
    [nombre_columna tipocolumna [restricciones_columna], ]
    [restricciones_tabla]
);
</code></pre><p>Donde las <span style="color:#4dd0e1">restricciones_columna</span> pueden ser:</p>
        <ul>
            <li><span style="color:#009688">PRIMARY KEY</span> &#8594 Especifica que esta columna es clave primaria.
                NOTA: Una clave primaria puede contener hasta 16 columnas.<ul>
                    <li>No puede haber más de una clave primaria por tabla.</li>
                    <li>Las columnas que la definen deben ser NOT NULL. (Se hace por defecto).</li>
                </ul>
            </li>
            <li><span style="color:#009688">FOREING KEY</span> &#8594 Permite establecer una clave en esta tabla con la clave primaria de otra.</li>
            <li><span style="color:#009688">NOT NULL</span> &#8594 Especifica que la columna debe recibir un valor en la creación o la modificación. La propiedad not null no se admite en el ALTER TABLE.</li>
            <li><span style="color:#009688">NULL</span> &#8594 Especifica que la columna puede tomar valores null.</li>
            <li><span style="color:#009688">DEFAULT</span> &#8594 Fuerza un valor para este campo si no existe.</li>
            <li><span style="color:#009688">AUTO_INCREMENT</span> &#8594 Propiedad aplicada únicamente a columna numérica entera y permite que el sistema genera automáticamente los números de manera incremental.</li>
            <li><span style="color:#009688">UNIQUE</span> &#8594 Permite asignar un valor único a un campo, por lo que todos los valores son diferentes en esa columna. Puede haber varias por tabla.</li>
            <li><span style="color:#009688">CHECK</span> &#8594 Especifica una comprobación en el valor de esta columna. </li>
        </ul>
        <br/>
        <br/>
        <h3>Ejemplo</h3>
        <pre class="prettyprint lang-sql"><code class="lang-roomsql">    <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> PROFESOR (
        <span class="hljs-keyword">ID</span> <span class="hljs-built_in">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span> PRIMARY <span class="hljs-keyword">KEY</span> AUTO_INCREMENT,
        NOMBRE <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,
        APELLIDO <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">100</span>) <span class="hljs-literal">NULL</span>,
        EDAD <span class="hljs-built_in">DATE</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,
        PROVINCIA <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">'Barcelona'</span>,
        SUELDO <span class="hljs-built_in">INT</span> <span class="hljs-keyword">CHECK</span>(&gt; <span class="hljs-number">5000</span>),
        ASIGNATURA <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">UNIQUE</span>,
    ) AUTO_INCREMENT = <span class="hljs-number">1000</span>;
</code></pre>
        <ul>
            <li>Si no especifico el <span style="color:#6aa84f">AUTO_INCREMENT</span> empieza en 1.</li>
            <li>Un único <span style="color:#6aa84f">AUTO_INCREMENT</span> por tabla y siempre en la <span style="color:#4dd0e1">Primary Key</span>.</li>
        </ul>
        <br/>
        <br/>
        <h3>Ejemplo</h3>
        <pre class="prettyprint lang-sql"><code class="lang-roomsql">    create table usuario(
        numero int auto_increment,
        documento char(<span class="hljs-number">8</span>),
        nombre varchar(<span class="hljs-number">30</span>),
        estudios <span class="hljs-class"><span class="hljs-keyword">enum</span>('<span class="hljs-title">ninguno</span>','<span class="hljs-title">primario</span>','<span class="hljs-title">secundario</span>','<span class="hljs-title">universitario</span>'),</span>
        primary key (numero)
    )
</code></pre>
        <ul>
            <li>Forma exclusiva de MySql para crear la <span style="color:#4dd0e1">Primary Key</span>.</li>
        </ul>
        <br/>
        <br/>
        <h3 id="-span-style-color-6aa84f-constraints-span-"><span style="color:#6aa84f">CONSTRAINTS</span></h3>
        <pre class="prettyprint lang-sql"><code>CREATE <span class="hljs-keyword">TABLE</span> nombre_tabla <span class="hljs-comment">(</span>
    nombre_columna tipocolumna [restricciones_columna],
    [nombre_columna tipocolumna [restricciones_columna], ]
    [restricciones_tabla]
);
</code></pre><p>Podemos, del mismo modo, crear restricciones <span style="color:#6aa84f">(CONSTRAINTS)</span> al final de la especificación de tablas (<span style="color:#4dd0e1">restricciones_tabla</span>) con los comandos:</p>
        <ul>
            <li><span style="color:#6aa84f">CONSTRAINT</span> nombrerestriccion <span style="color:#009688">DEFAULT</span> valor FOR nombrecolumna</li>
            <li><span style="color:#6aa84f">CONSTRAINT</span> nombrerestriccion <span style="color:#009688">PRIMARY KEY</span> (nombrecolumna1,....)<ul>
                <li>NOTA: Es la única manera de hacer una clave primaria compuesta.</li>
            </ul>
            </li>
            <li><span style="color:#6aa84f">CONSTRAINT</span> nombrerestriccion <span style="color:#009688">UNIQUE</span> (nombrecolumna1, ...)</li>
            <li><span style="color:#6aa84f">CONSTRAINT</span> FK_ nombrerest <span style="color:#009688">FOREIGN KEY</span> (nombrecol) <span style="color:#009688">REFERENCES</span> NombreTabla (columnaId)<ul>
                <li>NOTA: Es la única manera de hacer una clave foranea.</li>
            </ul>
            </li>
        </ul>
        <br/>
        <br/>
        <h3 id="ejemplo">Ejemplo</h3>
        <pre class="prettyprint lang-sql"><code class="lang-roomsql">    <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> PROFESOR (
        <span class="hljs-keyword">ID</span> <span class="hljs-built_in">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span> AUTO_INCREMENT,
        NOMBRE <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">100</span>),
        APELLIDO <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">100</span>),
        EDAD <span class="hljs-built_in">DATE</span>,
        PROVINCIA <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">100</span>),
        SUELDO <span class="hljs-built_in">INT</span>,
        ID_ASIGNATURA <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">100</span>),
        <span class="hljs-keyword">CONSTRAINT</span> PK_PROFESOR PRIMARY <span class="hljs-keyword">KEY</span> (<span class="hljs-keyword">ID</span>),
        <span class="hljs-keyword">CONSTRAINT</span> UNIQUE_PROFESOR_ASIGNATURA <span class="hljs-keyword">UNIQUE</span> (NOMBRE),
        <span class="hljs-keyword">CONSTRAINT</span> PROVINCIA_DEFAULT <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">'Barcelona'</span> <span class="hljs-keyword">FOR</span> PROVINCIA,
        <span class="hljs-keyword">CONSTRAINT</span> FK_PROFESOR_ASIGNATURA FOREIGN <span class="hljs-keyword">KEY</span> (ID_ASIGNATURA) <span class="hljs-keyword">REFERENCES</span> ASINTATURAS (<span class="hljs-keyword">ID</span>)
    );
</code></pre>
        <br/>
        <br/>
        <h2 id="-span-style-color-009688-actividad-1-span-"><span style="color:#009688">Actividad 1</span></h2>
        <p>Dadas las tablas, <span style="color:#4dd0e1">CLIENTES</span> y <span style="color:#4dd0e1">FACTURAS</span>, crea un script para cada una de ellas:</p>
        <pre class="prettyprint lang-sql"><code>CLIENTES
CIF (<span class="hljs-name">PK</span>)
Nombre (<span class="hljs-name">no</span> nulo)
Direccion
Poblacion (<span class="hljs-name">default</span> ‘Barcelona’)
Web
Correo
</code></pre><hr>
        <pre class="prettyprint lang-sql"><code>FACTURAS
Idfactura (<span class="hljs-name">PK</span> - autoincremental empieza en <span class="hljs-number">100</span> y no nula)
Fechafactura
Total (<span class="hljs-name">n</span>úmero con dos decimales)
Iva (<span class="hljs-name">check</span> de mínimo <span class="hljs-number">21</span>)
Descuento (<span class="hljs-name">Permite</span> nulos)
CIF (<span class="hljs-name">FK</span> CLIENTE)
</code></pre>
        <br/>
        <br/><details>
        <summary><span style="color:#6aa84f;font-size:150%">Solución</span></summary>

        <pre class="prettyprint lang-sql">
CREATE TABLE CLIENTES (
    CIF char(9) primary key auto_increment,
    nombre varchar(30) not null,
    direccion varchar(100),
    poblacion varchar(100) default &#39;Barcelona&#39;,
    web varchar(60),
    correo varchar(40)
);
</pre>
        <hr>
        <pre class="prettyprint lang-sql">
CREATE TABLE facturas (
    Idfactura int auto_increment primary key not null,
    Fechafactura date,
    total decimal(10,2),
    iva decimal(10,2),
    descuento decimal(10,2) check(&gt;20) null,
    CIF char(9) ,
    constraint fk_clientes_facturas foreign key(CIF) references clientes(CIF)
) auto_increment = 100;</pre>
    </details>

        <br/>
        <br/>
        <h2 id="-span-style-color-009688-actividad-2-span-"><span style="color:#009688">Actividad 2</span></h2>
        <p>Ahora ejecuta el script en la base de datos.</p>
        <hr>
        <br/>
        <br/>
        <br/>
        <br/>



        <!-- HERE ENDS THE CODE -->

    </div>
</div>
</body>
</html>